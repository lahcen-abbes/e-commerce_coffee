{% extends 'base.html' %}
{% load static %}
{% block title %}Product details{% endblock %}
{% block content %}
<div class="my-form container p-5 my-5 rounded border border-warning">
    <form id="frmaddtocart" action="{% url 'add_to_cart' %}"> <!--mor ma ydir utilisateur submit yedih 3nd url add_to_cart w url yedih 3nd views li fiha def tedik wla tredirectik lel une autre page -->
        <h2 class="text-center">Product Details</h2>
        <hr>
        {% include  'partials/_alerts.html' %} <!--ta3 messages-->
        <section>
            
              <div class="row p-5 " >

                <div class="card mb-3 w-100" >
                  <div class="row no-gutters">
                    <div class="col-md-4">
                      <img src="{{ pro.photo.url }}" class="card-img" alt="...">
                    </div>
                    <div class="col-md-8">
                      <div class="card-body">
                        <h5 class="card-title" id="productName">{{ pro.name }}</h5>
                        <hr>
                        <p class="card-text" id="description">{{ pro.description }}</p>
                        <hr>
                        <p class="card-text">Current Price: <span id="price" class="bg-dark text-light rounded-circle p-2">${{ pro.price }}</span></p>
                        <hr>
                        <button type="button" class="btn btn-warning"
                        data-toggle="modal" data-target="#exampleModal">Add To Cart</button>



<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Select Quantity</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <label for="inputQty">Quantity: </label>
            <input type="text" class="form-control" value="1" name="qty" id="inputQty" placeholder="" required> <!--remarque name hiya li tetafficha fl url ki ykon method="GET"-->
            <input type="hidden" name="pro_id" value="{{pro.id}}"> <!--drna hak bach id ta3 product yettafficha fl url psq rana dayrin method="GET" exemple nedekhlo fl product id ta3h 4 yettafficha pro_id=4-->
            <input type="hidden" name="price" value="{{pro.price}}">
          </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal" id="btnclose">Close</button>
        <button onclick="addtocart()" class="btn btn-warning" >Confirm</button>
      </div>
    </div>
  </div>
</div>


                        <a 
                        href="{% url 'product_favorite' pro_id=pro.id %}" 
                        type="submit" class="btn btn-warning text-white">
                          <svg class="bi bi-star-fill" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                            <path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.283.95l-3.523 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"/>
                          </svg>
                        </a>
                        <hr>

                        <a href="{% url 'products' %}" class="btn btn-warning">All Products</a>

                        <a href="{% url 'index' %}" class="btn btn-warning text-white">
                          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-house-door-fill" viewBox="0 0 16 16">
                            <path d="M6.5 14.5v-3.505c0-.245.25-.495.5-.495h2c.25 0 .5.25.5.5v3.5a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5Z"/>
                          </svg>
                        </a>
                        
                      </div>
                    </div>
                  </div>
                </div>

              </div>
            
        </section>
    

    </form>


<script>
  function addtocart() {
    document.getElementById('btnclose').click(); //btnclose hiya id ta3 close fl model ta3 add to cart f product details golnaleh clicki 3la close w function hadi rahi fk input ta3 Confirm tsama ki yeclicki 3la Confirm yesra close drnaha psq close tegle3 dik fenÃªtre btari9a jmila, tsama ki neclicko 3la Confirm tkeli clickina 3la Close
    //t = setTimeout(function(){}, 5000) //setTimeout tkheli f function tetnefed kol 5 secondes 
    //clearTimeout(t); //y7ebes function once 5 secondes li lfog tekmel
    document.getElementById('frmaddtocart').submit(); //frmaddtocart id rahi fl form lfog tsama ki neclicko 3la Confirm tekeli drna Close(chre7na lfog) w tkeli tani derna submit lel form li id ta3ha frmaddtocart
  }
</script>
</div>
{% endblock %}